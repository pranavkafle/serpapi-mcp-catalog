<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SerpApi MCP System Prompt Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&family=Fraunces:wght@600&display=swap");

    :root {
      --bg-1: #f6f1e7;
      --bg-2: #e8f2ef;
      --ink: #1e1f1f;
      --muted: #6a6f73;
      --accent: #0f6f63;
      --border: #e2e2e2;
      --shadow: 0 20px 50px rgba(0, 0, 0, 0.08);
    }

    body {
      font-family: "Space Grotesk", system-ui, -apple-system, sans-serif;
      color: var(--ink);
      background: radial-gradient(1200px 600px at 15% -10%, var(--bg-2), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, #fff7e6, transparent 55%),
        var(--bg-1);
    }

    .page-wrap {
      max-width: 1100px;
    }

    .page-eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-size: 12px;
      color: var(--muted);
    }

    .page-title {
      font-family: "Fraunces", serif;
    }

    .card {
      border-radius: 18px;
      border-color: var(--border);
      box-shadow: var(--shadow);
    }

    .form-label {
      text-transform: uppercase;
      letter-spacing: 0.14em;
      font-size: 12px;
      color: var(--muted);
    }

    .form-text {
      color: var(--muted);
      font-size: 13px;
    }

    .engine-badge {
      background: #f7f3ea;
      color: #7a5b36;
      font-weight: 500;
    }

    .engine-id-wrap {
      min-height: calc(1.5em + 0.75rem + (var(--bs-border-width) * 2));
    }

    .form-control.prompt-output {
      min-height: 460px;
      max-height: 640px;
      padding-right: 4.25rem;
      background: #fafafa;
    }

    .copy-btn {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 1px solid #e1e7e6;
      color: var(--accent);
      background: #ffffff;
      top: 12px;
      right: 24px;
    }

    .copy-btn:hover {
      color: var(--accent);
      box-shadow: 0 8px 16px rgba(14, 48, 42, 0.12);
      transform: translateY(-1px);
    }

    .text-muted {
      color: var(--muted) !important;
    }

    .card-footer {
      border-top: none;
      padding-top: 0;
      background: transparent;
    }

    .source-link {
      color: inherit;
      text-decoration: underline;
      text-decoration-color: #d1d4d6;
    }

    .source-link:hover {
      color: inherit;
      text-decoration-color: #b8bdc0;
    }
  </style>
</head>

<body>
  <main class="container page-wrap py-5">
    <div class="mb-4">
      <div class="page-eyebrow">SerpApi MCP</div>
      <h1 class="display-6 page-title">System Prompt Generator</h1>
      <p class="text-muted mb-0">
        Built for the official SerpApi MCP server
        (<a class="source-link" href="https://github.com/serpapi/serpapi-mcp" target="_blank" rel="noreferrer">GitHub</a>).
        Use this to help any agent or app craft stronger system prompts grounded in the engine's documented parameters and examples.
        The MCP docs can be sparse or inconsistent across engines, so this catalog fills that gap by consolidating parameter guidance into a usable prompt.
      </p>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        <div class="row g-3 mb-2">
          <div class="col-md-6">
            <label for="engineSelect" class="form-label">Engine</label>
            <select id="engineSelect" class="form-select"></select>
          </div>
          <div class="col-md-6">
            <label class="form-label text-md-end w-100">Selected Engine ID</label>
            <div class="d-flex justify-content-md-end align-items-center engine-id-wrap">
              <span id="engineId" class="badge engine-badge">-</span>
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label">Engine Description</label>
          <p id="engineDescription" class="form-text">Select an engine to view its description.</p>
        </div>

        <div class="mb-3">
          <label class="form-label" for="promptOutput">Generated Prompt</label>
          <div class="position-relative">
            <button type="button" id="copyBtn" class="btn btn-sm position-absolute copy-btn"
              title="Copy prompt" aria-label="Copy prompt">
              <i class="bi bi-clipboard"></i>
            </button>
            <textarea id="promptOutput" class="form-control prompt-output"
              placeholder="Your system prompt will appear here."></textarea>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <small class="text-muted fst-italic">
          Source: <a id="docUrl" class="source-link" href="#" target="_blank" rel="noreferrer">-</a>
        </small>
      </div>
    </div>
  </main>

  <script>
    const dataRoot = "data/engines-normalized";
    const indexUrl = "data/engine-index.json";

    const engineSelect = document.getElementById("engineSelect");
    const engineId = document.getElementById("engineId");
    const engineDescription = document.getElementById("engineDescription");
    const docUrl = document.getElementById("docUrl");
    const promptOutput = document.getElementById("promptOutput");

    const engineCache = new Map();
    let engines = [];

    const titleCase = (text) => text
      .replace(/_/g, " ")
      .replace(/\b\w/g, (c) => c.toUpperCase());

    const safe = (value, fallback = "") => value || fallback;

    const formatOptions = (options) => {
      if (!Array.isArray(options) || options.length === 0) return "";
      const preview = options.slice(0, 5).map((item) => {
        if (Array.isArray(item)) return `${item[0]}=${item[1]}`;
        return String(item);
      });
      const suffix = options.length > preview.length ? ", â€¦" : "";
      return ` Options: ${preview.join(", ")}${suffix}`;
    };

    const flattenParams = (payload) => {
      const params = [];
      Object.entries(payload || {}).forEach(([groupName, group]) => {
        const groupParams = group && group.parameters ? group.parameters : {};
        Object.entries(groupParams).forEach(([name, spec]) => {
          params.push({ name, group: groupName, ...spec });
        });
      });
      return params;
    };

    const renderPrompt = (engine) => {
      if (!engine) return "";

      const name = titleCase(engine.engine);
      const params = flattenParams(engine.payload);
      const required = params.filter((p) => p.required === true);
      const optional = params.filter((p) => p.required === false);
      const unspecified = params.filter((p) => p.required !== true && p.required !== false);
      const exampleParams = { engine: engine.engine };
      required.forEach((param) => {
        if (param.name === "engine" || param.name === "api_key") return;
        const typeHint = param.type ? `:${param.type}` : "";
        exampleParams[param.name] = `<required${typeHint}>`;
      });

      const lines = [];
      lines.push(`You are a SerpApi MCP assistant focused on: ${name}.`);
      lines.push("");
      lines.push("Goal:");
      lines.push(`- Provide accurate results using the SerpApi MCP tool for ${name}.`);
      lines.push("- Use the engine parameters below to shape searches.");
      lines.push("");
      lines.push("Tooling:");
      lines.push("- Use mcp__serpapi__search with { params, mode }.");
      lines.push(`- Always set params.engine to "${engine.engine}".`);
      lines.push('- Prefer mode="compact" unless the user asks for full payloads.');
      lines.push("- The SerpApi API key is provided by the MCP server; do not include api_key in params.");
      lines.push("");
      lines.push("Required parameters:");
      if (required.length === 0) {
        lines.push("- None listed.");
      } else {
        required.filter((p) => p.name !== "api_key").forEach((p) => {
          const desc = safe(p.description, "No description.");
          const type = p.type ? ` Type: ${p.type}.` : "";
          lines.push(`- ${p.name}: ${desc}${type}${formatOptions(p.options)}`);
        });
      }
      lines.push("");
      lines.push("Optional parameters:");
      if (optional.length === 0) {
        lines.push("- None listed.");
      } else {
        optional.filter((p) => p.name !== "api_key").forEach((p) => {
          const desc = safe(p.description, "No description.");
          const type = p.type ? ` Type: ${p.type}.` : "";
          lines.push(`- ${p.name}: ${desc}${type}${formatOptions(p.options)}`);
        });
      }
      if (unspecified.length > 0) {
        lines.push("");
        lines.push("Other parameters:");
        unspecified.filter((p) => p.name !== "api_key").forEach((p) => {
          const desc = safe(p.description, "No description.");
          const type = p.type ? ` Type: ${p.type}.` : "";
          lines.push(`- ${p.name}: ${desc}${type}${formatOptions(p.options)}`);
        });
      }
      lines.push("");
      lines.push("Behavior rules:");
      lines.push("- If a required parameter is missing, ask a targeted follow-up question.");
      lines.push("- Do not invent unsupported parameters; stick to this engine's list.");
      lines.push("- If the user requests a filter, map it to optional params when possible.");
      lines.push("- Cite the engine name and explain what it returns.");
      lines.push("");
      lines.push("Example MCP call (JSON):");
      const exampleCall = JSON.stringify({ params: exampleParams, mode: "compact" }, null, 2);
      lines.push(exampleCall);

      return lines.join("\n");
    };

    const updateUI = (engine) => {
      if (!engine) return;
      const name = titleCase(engine.engine);
      engineId.textContent = engine.engine;
      engineDescription.textContent = "Descriptions and doc links are not included in this dataset.";
      docUrl.textContent = "-";
      docUrl.href = "#";
      docUrl.classList.add("disabled");
      docUrl.setAttribute("aria-disabled", "true");
      promptOutput.value = renderPrompt(engine);
      document.title = `${name} Prompt Generator`;
    };

    const loadEngine = async (engineId) => {
      if (engineCache.has(engineId)) {
        return engineCache.get(engineId);
      }
      const res = await fetch(`${dataRoot}/${engineId}.json`);
      if (!res.ok) {
        throw new Error(`Failed to load engine data: ${engineId}`);
      }
      const data = await res.json();
      engineCache.set(engineId, data);
      return data;
    };

    const applyIndex = (engineList) => {
      engines = Array.isArray(engineList) ? engineList : [];
      engineSelect.innerHTML = "";

      engines.forEach((engine, index) => {
        const option = document.createElement("option");
        option.value = engine;
        option.textContent = titleCase(engine);
        engineSelect.appendChild(option);
        if (index === 0) engineSelect.value = engine;
      });
    };

    const init = async () => {
      const res = await fetch(indexUrl);
      if (!res.ok) {
        throw new Error("Failed to load engine index.");
      }
      const payload = await res.json();
      applyIndex(payload.engines || []);
      const engine = await loadEngine(engineSelect.value);
      updateUI(engine);
    };

    engineSelect.addEventListener("change", async () => {
      const engine = await loadEngine(engineSelect.value);
      updateUI(engine);
    });

    document.getElementById("copyBtn").addEventListener("click", async () => {
      if (!promptOutput.value) return;
      await navigator.clipboard.writeText(promptOutput.value);
      const btn = document.getElementById("copyBtn");
      const original = btn.innerHTML;
      btn.innerHTML = '<i class="bi bi-check2"></i>';
      setTimeout(() => {
        btn.innerHTML = original;
      }, 900);
    });

    init().catch((err) => {
      engineDescription.textContent = "Failed to load engine data.";
      console.error(err);
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
</body>

</html>
